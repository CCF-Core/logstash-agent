filter {
  #---------------------------------------------------------------------------
  # Parse messages coming from swift
  #
  if [type] == "swift" {
    grok {
      match => [ "message", '%{IPORHOST:swift_client_ip} (?:%{WORD}:swift_ident|-) (?:%{WORD}:swift_auth|-) \[%{HTTPDATE:swift_timestamp}\] "%{WORD:swift_request_verb} %{NOTSPACE:swift_request}" %{NUMBER:swift_response_code:int} (?:%{WORD}:thing3|-) "%{DATA:swift_referrer_verb} %{DATA:swift_referrer}" "%{DATA:swift_txn}" "%{DATA:swift_logged_headers}" %{NUMBER:swift_trans_time:float} "-" %{NUMBER:swift_response_bytes:int}' ]
      match => [ "message", '%{IPORHOST:swift_client_ip} %{IPORHOST:swift_server_ip} %{MONTHDAY}/%{MONTH}/%{YEAR}/%{HOUR}/%{MINUTE}/%{SECOND} %{WORD:swift_request_verb} %{NOTSPACE:swift_request} HTTP/%{NUMBER:httpversion:float} %{NUMBER:swift_response_code:int} %{DATA:swift_referrer} %{DATA:swift_user_agent} %{DATA:swift_swift_auth_token} %{NUMBER:swift_request_bytes:int} %{NUMBER:swift_response_bytes:int} %{DATA:swift_etag} %{DATA:swift_txn} %{DATA:swift_logged_headers} %{NUMBER:swift_trans_time:float}' ]
      match => [ "message", '%{NOTSPACE:swift_server_type}: %{WORD:swift_log_source}\: %{IPORHOST:swift_source_ip} (?:%{WORD}:swift_ident|-) (?:%{WORD}:swift_auth|-) \[%{MONTHDAY}\/%{MONTH}\/%{YEAR} %{TIME}\] \"%{WORD:swift_request_verb} %{NOTSPACE:swift_request} HTTP\/%{NUMBER:swift_http_version:float}\" %{NUMBER:swift_response_code:int} %{NUMBER:swift_response_bytes:int} %{NUMBER:swift_response_time:float} \(txn\: %{NOTSPACE:swift_txn}\)' ]
      match => [ "message", '%{NOTSPACE:swift_server_type}: %{IPORHOST:swift_source_ip} %{IPORHOST:swift_server_ip} %{MONTHDAY}\/%{MONTH}\/%{YEAR}\/%{HOUR}\/%{MINUTE}\/%{SECOND} %{WORD:swift_request_verb} %{NOTSPACE:swift_request} HTTP/%{NUMBER:swift_httpversion:float} %{NUMBER:swift_response_code:int} %{DATA:swift_referrer} %{NOTSPACE:swift_user_agent} swift_auth_%{NOTSPACE:swift_swift_auth_token}... (?:%{NUMBER:swift_response_bytes:int}|-) (?:%{WORD}:swift_ident|-) (?:%{WORD}:swift_auth|-) %{NOTSPACE:swift_txn} - %{NUMBER:swift_response_time:float} - - %{NUMBER:swift_response_start_ms:float} %{NUMBER:swift_response_end_ms:float}' ]
      match => [ "message", "%{NOTSPACE:swift_server_type}\: %{WORD:swift_log_source}\: \(%{NUMBER}\) %{WORD:swift_connection_state} \(\'%{IPORHOST:swift_client_ip}\', %{NUMBER:swift_connection_port:int}\)" ]
      match => [ "message", "\(trans_id %{DATA:swift_txn}\)" ]
      match => [ "message", "\(txn: %{DATA:swift_txn}\)" ]
      break_on_match => false
      tag_on_failure => []
    }
  }
}
